setwd("~/projects/r/uw450/HW4")
install.packages("binr")
library(binr)
vid = read.csv("Video_Store.csv")
vid = data.frame(vid)
bin.age = bins(vid$Age, target.bins = 12, max.breaks = 18)
bin.age
binned.age = cut(vid$Age, breaks = c(0,19,21,24,25,30,32,33,35,38,45,47,70), labels = c('15-16','18-19',
'20-21','22-24','25-25','28-30',
'32-33','35-35','36-38','40-45',
'46-47','52-70'))
binned.age
vid$binned.age = binned.age
vid
min.max.income = (vid$Income - min(vid$Income))/(max(vid$Income)- min(vid$Income))
vid$min.max.income = min.max.income
vid
znorm.rental = scale(vid$Rentals, center = TRUE, scale = TRUE)
vid$znorm.rental = znorm.rental
vid
category.income = rep(NA, length(vid$Income))
category.income[vid$Income>=60000] = "High"
category.income[vid$Income >=25000 & vid$Income<60000] = "Mid"
category.income[vid$Income < 25000] = "Low"
vid$category.income = category.income
vid
matrix.vid = model.matrix(vid)
vid = read.csv("Video_Store.csv")
matrix.vid = model.matrix(vid)
vid
vid = data.frame(vid)
matrix.vid = model.matrix(vid)
str(vid)
matrix.vid = model.matrix(~Rentals, data = vid)
matrix.vid
matrix.vid = model.matrix(Rentals~., data = vid)
matrix.vid
k = model.matrix(~Gender, data = vid)
k
names(vid)
newvid$Cust.ID = vid$Cust.ID
GenderM = rep(NA,length(vid$Gender))
GenderM[vid$Gender == "M"] = 1
GenderM[vid$Gender != "M"] = 0
GenderM
str(vid)
IncidentalsNo = rep(0, length(vid$Incidentals))
IncidentalsNo[vid$Incidentals == "No"] = 1
IncidentalsYes = rep(0, length(vid$Incidentals))
IncidentalsYes[vid$Incidentals == "Yes"] = 1
str(vid$Genre)
vid$Genre
names(vid)
newvid = cbind(vid$Cust.ID, GenderM, GenderF, vid$Income, vid$Age, vid$Rentals, vid$Avg.Per.Visit,
IncidentalsNo, IncidentalsYes, GenreDrama,GenreAction, GenreComedy)
GenderM = rep(0,length(vid$Gender))
GenderM[vid$Gender == "M"] = 1
GenderF = rep(0,length(vid$Gender))
GenderF[vid$Gender == "F"] = 1
IncidentalsNo = rep(0, length(vid$Incidentals))
IncidentalsNo[vid$Incidentals == "No"] = 1
IncidentalsYes = rep(0, length(vid$Incidentals))
IncidentalsYes[vid$Incidentals == "Yes"] = 1
GenreComedy = rep(0, length(vid$Genre))
GenreComedy[vid$Genre == 'Comedy'] = 1
GenreAction = rep(0, length(vid$Genre))
GenreAction[vid$Genre == 'Action'] = 1
GenreDrama = rep(0, length(vid$Genre))
GenreDrama[vid$Genre == 'Drama'] = 1
newvid = cbind(vid$Cust.ID, GenderM, GenderF, vid$Income, vid$Age, vid$Rentals, vid$Avg.Per.Visit,
IncidentalsNo, IncidentalsYes, GenreDrama,GenreAction, GenreComedy)
dim(newvid)
dim(vid)
names(newvid) = c("Cust.ID","GenderM","GenderF","Income","Age","Rentals","Avg.Per.Visit",
"IncidentalsNo","IncidentalsYes","GenreDrama","GenreAction","GenreComedy")
newvid
newvid = cbind(vid$Cust.ID, GenderM, GenderF, vid$Income, vid$Age, vid$Rentals, vid$Avg.Per.Visit,
IncidentalsNo, IncidentalsYes, GenreDrama,GenreAction, GenreComedy)
newvid
names(newvid)
names(newvid) = c("Cust.ID","GenderM","GenderF","Income","Age","Rentals","Avg.Per.Visit",
"IncidentalsNo","IncidentalsYes","GenreDrama","GenreAction","GenreComedy")
newvid
newvid = data.frame(cbind(vid$Cust.ID, GenderM, GenderF, vid$Income, vid$Age, vid$Rentals, vid$Avg.Per.Visit,
IncidentalsNo, IncidentalsYes, GenreDrama,GenreAction, GenreComedy))
names(newvid)
names(newvid) = c("Cust.ID","GenderM","GenderF","Income","Age","Rentals","Avg.Per.Visit",
"IncidentalsNo","IncidentalsYes","GenreDrama","GenreAction","GenreComedy")
newvid
library(ellipse)
install.packages("ellipse")
install.packages("corrplot")
library(ellipse)
vidcor = cor( wine[,c("GenderM","GenderF","Income","Age","Rentals","Avg.Per.Visit",
"IncidentalsNo","IncidentalsYes","GenreDrama","GenreAction","GenreComedy") ], method = "pearson")
vidcor = cor( newvid[,c("GenderM","GenderF","Income","Age","Rentals","Avg.Per.Visit",
"IncidentalsNo","IncidentalsYes","GenreDrama","GenreAction","GenreComedy") ], method = "pearson")
library(corrplot)
corrplot(vidcor, method="circle", type='lower')
vidcor
?xtabs
xtabs(newvid$GenderM+newvid$GenderF ~ newvid$GenreAction)
xtabs(newvid$GenderM+newvid$GenderF ~ newvid$GenreAction + newvid$GenreDrama + newvid$GenreComedy)
crosstab(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
?ctab
install.packages("descr")
library(descr)
crosstab(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
ctab(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
library(descr)
?descr
?ctab
??ctab
?crosstab
crosstab(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
CrossTable(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
crosstab(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
freq(newvid, row.vars = "GenderM", col.vars = "GenreDrama", type = "f")
?freq
?CrossTable
CrossTable(newvid)
xtabs(~ newvid$GenderF + newvid$GenreComedy)
xtabs(~ newvid$GenderM + newvid$GenreComedy)
FemalComedy = xtabs(~ newvid$GenderF + newvid$GenreComedy)
MaleComedy = xtabs(~ newvid$GenderM + newvid$GenreComedy)
FemaleComedy = xtabs(~ newvid$GenderF + newvid$GenreComedy)
MaleComedy = xtabs(~ newvid$GenderM + newvid$GenreComedy)
FemaleComedy[1][1]
FemaleComedy[2][2]
FemaleComedy
FemaleComedy[1][1]
FemaleComedy[1][2]
FemaleComedy[0][0]
FemaleComedy[newvid$GenreComedy ==1]
FemaleComedy[newvid$GenreComedy ==1 & newvid$GenderF == 1]
FemaleComedy[1]
FemaleComedy[2]
FemaleComedy[3]
FemaleComedy[4]
GenreComedyCol[1] = FemaleComedy[4]
GenreComedyCol = rep(NA,2)
GenreComedyCol[1] = FemaleComedy[4]
FemaleComedy
FemaleComedy[3]
FemaleComedy[2]
FemaleComedy = xtabs(~ newvid$GenderF + newvid$GenreComedy)
MaleComedy = xtabs(~ newvid$GenderM + newvid$GenreComedy)
GenreComedyCol = rep(NA,2)
GenreComedyCol[1] = FemaleComedy[4]
GenreComedyCol[2] = MaleComedy[4]
FemaleDrama = xtabs(~ newvid$GenderF + newvid$GenreDrama)
MaleDrama = xtabs(~ newvid$GenderM + newvid$GenreDrama)
GenreDramaCol = rep(NA,2)
GenreDramaCol[1] = FemaleDrama[4]
GenreDramaCol[2] = MaleDrama[4]
FemaleAction= xtabs(~ newvid$GenderF + newvid$GenreAction)
MaleAction = xtabs(~ newvid$GenderM + newvid$GenreAction)
GenreActionCol = rep(NA,2)
GenreActionCol[1] = FemaleAction[4]
GenreActionCol[2] = MaleAction[4]
GenderGenre = cbind(GenreComedyCol,GenreActionCol,GenreDramaCol)
GenderGenre
vid[Gender == "Female" && Genre == "Comedy"]
names(vid)
vid[Gender == "F" && Genre == "Comedy"]
vid[vid$Gender == "F" && vid$Genre == "Comedy"]
vid
vid[vid$Gender == "F" & vid$Genre == "Comedy"]
vid[vid$Gender == "F"]
vid$Gender == "F"
vid[vid$Gender == "F",]
vid[vid$Gender == "F" & vid$Genre == 'Comedy',]
GenderGenre
vid[vid$Gender == "M" & vid$Genre == 'Comedy',]
vid[vid$Gender == "M" & vid$Genre == 'Action',]
vid[vid$Gender == "M" & vid$Genre == 'Drama',]
vid[vid$Gender == "F" & vid$Genre == 'Action',]
vid[vid$Gender == "F" & vid$Genre == 'Drama',]
row.names(GenderGenre)
row.names(GenderGenre) = c("Female","Male")
GenderGenre
HighRentals = vid[vid$Rentals >= 30,]
summary(HighRentals)
summary(vid)
summary(vid$Incidentals)
HighIncidentals = vid[vid$Incidentals == "Yes",]
summary(HighIncidentals)
summary(vid)
